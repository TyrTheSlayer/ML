combo.temp_precip = merge(temp, greatest_precip, by= "ID")
combo.temp_precip = merge(temp, greatest_precip, by.x= "ID")
combo.temp_precip = merge(temp, greatest_precip, by= "state")
View(combo.temp_precip)
combo.temp_precip = merge(temp[1:,], greatest_precip[1:,], by= "state")
combo.temp_precip = merge(temp[1:], greatest_precip[1:], by= "state")
combo.temp_precip = merge(temp[,-1], greatest_precip[,-1], by= "state")
View(combo.temp_precip)
print(combo.temp_precip[1,])
print(combo.temp_precip[2,])
print(combo.temp_precip[,2])
print(combo.temp_precip[2:25])
h2 <- heatmap(scale(combo.temp_precip[2:25]), distfun = dist, keep.dendro = T,labRow = temp$state,
main="Cluster on mean/precipitation", xlab = "Month")
mean_precip_tree = hclust(dist(scale(combo.temp_precip[2:25])), "ave")
plot(mean_precip_tree, labels = snowfall$state, main = "Mean temp/precipitation Dendrogram")
mean_precip_tree = hclust(dist(scale(combo.temp_precip[2:25])), "ave")
plot(mean_precip_tree, labels = combo.temp_precip$state, main = "Mean temp/precipitation Dendrogram")
combo.min_max_temp = merge(max_temp[,-1], min_temp[,-1], by= "state")
combo.all_temp = merge(combo.min_max_temp, temp[,-1], by= "state")
print(combo.all_temp[2:37])
h3 <- heatmap(scale(combo.all_temp[2:37]), distfun = dist, keep.dendro = T,labRow = combo.all_temp$state,
main="Cluster on all temp", xlab = "Month")
all_temp_tree = hclust(dist(scale(combo.all_temp[2:37])), "ave")
plot(all_temp_tree, labels = combo.all_tem$state, main = "All Temp Dendrogram")
plot(all_temp_tree, labels = combo.all_temp$state, main = "All Temp Dendrogram")
all_temp_tree = hclust(scale(combo.all_temp[2:37]), "ave")
#function to split strings an return a dataframe
strtodf<-function (list){
slist<-strsplit(list, ":")
x<-sapply(slist, FUN= function(x) {x[1]})
y<-sapply(slist, FUN= function(x) {x[2]})
df<-data.frame(state=x, island=y, stringsAsFactors = FALSE)
return(df)
}
#user defined coloring scheme
#    Example data for to test solution
colors<- c("#7aad42","#4a77bb","#f7931e","#d3dfbd","#787878")
region<-c("washington", "new york", "virginia", "pennsylvania", "ohio")
states_info<-data.frame(region, colors)
#dataframe to hold state names for mapping purposes
library(maps)
maplist<-map("state", namesonly = TRUE, plot=FALSE)
statelist<-strtodf(maplist)  #convert to dataframe
statelist$row<-as.numeric(rownames(statelist))  #index column
#merge the data from and resort into proper order
statelist<-merge(statelist, states_info, by.x = "state", by.y="region", sort=FALSE, all.x=TRUE)
statelist<-statelist[order(statelist$row),]
#plot the map
maplist<-map("state", fill=TRUE, col=statelist$colors)
library(ggplot2)
read.table(text="State.Code   region St_Abbr Num_Estab  colors
1          1   alabama      AL     13123 #f7931e
3          4   arizona      AZ     18053 #f7931e
4          5   arkansas      AR      9154 #4a77bb
5          6   california      CA    143937 #787878
6          8   colorado      CO     21033 #d3dfbd
7          9   connecticut      CT     17176 #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="State.Code   region St_Abbr Num_Estab  colors
1          1   alabama      AL     13123 #f7931e
2          1   alaska      AK     13123 #f7931e
3          4   arizona      AZ     18053 #f7931e
4          5   arkansas      AR      9154 #4a77bb
5          6   california      CA    143937 #787878
6          8   colorado      CO     21033 #d3dfbd
7          9   connecticut      CT     17176 #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
View(usa_map)
read.table(text="State.Code   region St_Abbr  colors
1          1   alabama      AL      #f7931e
3          4   arizona      AZ      #f7931e
4          5   arkansas      AR       #4a77bb
5          6   california      CA     #787878
6          8   colorado      CO      #d3dfbd
7          9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="State.Code   region St_Abbr  colors
1          1   alabama      AL      #f7931e
63        1    wyoming      WY      #f7931e
3          4   arizona      AZ      #f7931e
4          5   arkansas      AR       #4a77bb
5          6   california      CA     #787878
6          8   colorado      CO      #d3dfbd
7          9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="State.Code   region St_Abbr  colors
1          1   alabama      AL      #f7931e
63        10    wyoming      WY      #f7931e
3          4   arizona      AZ      #f7931e
4          5   arkansas      AR       #4a77bb
5          6   california      CA     #787878
6          8   colorado      CO      #d3dfbd
7          9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="State.Code   region St_Abbr  colors
1          1   alabama      AL      #f7931e
3          4   arizona      AZ      #f7931e
4          5   arkansas      AR       #4a77bb
5          6   california      CA     #787878
6          8   colorado      CO      #d3dfbd
7          9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="State.Code   region St_Abbr  colors
1          1   alabama      AL      #f7931e
1        10    wyoming      WY      #f7931e
3          4   arizona      AZ      #f7931e
4          5   arkansas      AR       #4a77bb
5          6   california      CA     #787878
6          8   colorado      CO      #d3dfbd
7          9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
read.table(text="State.Code   region St_Abbr  colors
1          1   alabama      AL      #f7931e
2        10    wyoming      WY      #f7931e
3          4   arizona      AZ      #f7931e
4          5   arkansas      AR       #4a77bb
5          6   california      CA     #787878
6          8   colorado      CO      #d3dfbd
7          9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="region St_Abbr  colors
1   alabama      AL      #f7931e
10    wyoming      WY      #f7931e
4   arizona      AZ      #f7931e
5   arkansas      AR       #4a77bb
6   california      CA     #787878
8   colorado      CO      #d3dfbd
9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="St_Abbr  colors
alabama      AL      #f7931e
wyoming      WY      #f7931e
arizona      AZ      #f7931e
arkansas      AR       #4a77bb
california      CA     #787878
colorado      CO      #d3dfbd
connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="St_Abbr  colors
1   alabama      AL      #f7931e
2    wyoming      WY      #f7931e
4   arizona      AZ      #f7931e
5   arkansas      AR       #4a77bb
6   california      CA     #787878
8   colorado      CO      #d3dfbd
9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
read.table(text="region St_Abbr  colors
1   alabama      AL      #f7931e
2    wyoming      WY      #f7931e
4   arizona      AZ      #f7931e
5   arkansas      AR       #4a77bb
6   california      CA     #787878
8   colorado      CO      #d3dfbd
9   connecticut      CT      #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="region  colors
1   alabama            #f7931e
2   arizona            #f7931e
3   arkansas           #4a77bb
4   california           #787878
5   colorado            #d3dfbd
6   connecticut            #f7931e
2    delaware            #f7931e
2    wyoming            #f7931e
2    wyoming            #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
read.table(text="region  colors
1   alabama            #f7931e
2   arizona            #f7931e
3   arkansas           #4a77bb
4   california           #787878
5   colorado            #d3dfbd
6   connecticut            #f7931e
7    delaware            #f7931e
8    wyoming            #f7931e
9    wyoming            #f7931e
10    wyoming            #f7931e
11    wyoming            #f7931e
12    wyoming            #f7931e
13    wyoming            #f7931e
14    wyoming            #f7931e
15    wyoming            #f7931e
16    wyoming            #f7931e
17    wyoming            #f7931e
18    wyoming            #f7931e
19    wyoming            #f7931e
20    wyoming            #f7931e
21    wyoming            #f7931e
22    wyoming            #f7931e
23    wyoming            #f7931e
24    wyoming            #f7931e
25    wyoming            #f7931e
26    wyoming            #f7931e
27    wyoming            #f7931e
28    wyoming            #f7931e
29    wyoming            #f7931e
30    wyoming            #f7931e
31    wyoming            #f7931e
32    wyoming            #f7931e
33    wyoming            #f7931e
34    wyoming            #f7931e
35    wyoming            #f7931e
36    wyoming            #f7931e
37    wyoming            #f7931e
38    wyoming            #f7931e
39    wyoming            #f7931e
40    wyoming            #f7931e
41    wyoming            #f7931e
42    wyoming            #f7931e
43    wyoming            #f7931e
44    wyoming            #f7931e
45    wyoming            #f7931e
46    wyoming            #f7931e
47    wyoming            #f7931e
48    wyoming            #f7931e
49    wyoming            #f7931e
50    wyoming            #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="region  colors
1   alabama            #f7931e
2   arizona            #f7931e
3   arkansas           #4a77bb
4   california           #787878
5   colorado            #d3dfbd
6   connecticut            #f7931e
7    delaware            #f7931e
8    florida            #f7931e
9    georgia            #f7931e
11    idaho            #f7931e
12    illinois            #f7931e
13    indiana            #f7931e
14    iowa            #f7931e
15    kansas            #f7931e
16    kentucky            #f7931e
17    louisiana           #f7931e
18    maine            #f7931e
19    maryland            #f7931e
20    massachusetts            #f7931e
21    michigan            #f7931e
22    minnesota            #f7931e
23    mississippi            #f7931e
24    missouri            #f7931e
25    montana            #f7931e
26    nebraska            #f7931e
27    nevada            #f7931e
28    newhampshire            #f7931e
29    newjersey          #f7931e
30    newmexico            #f7931e
31    newyork            #f7931e
32    northcarolina            #f7931e
33    northdakota            #f7931e
34    ohio            #f7931e
35    oklahoma            #f7931e
36    oregon            #f7931e
37    pennsylvania            #f7931e
38    rhodeisland            #f7931e
39    southcarolina            #f7931e
40    southdakota            #f7931e
41    tennessee            #f7931e
42    texas            #f7931e
43    utah            #f7931e
44    vermont            #f7931e
45    virginia            #f7931e
46    washington            #f7931e
47    westvirginia            #f7931e
48    wisconsin            #f7931e
49    wyoming            #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
usa_map <- map_data("state")
gg <- ggplot()
gg <- gg + geom_map(data=usa_map, map=usa_map,
aes(long, lat, map_id=region),
color="#2b2b2b", size=0.15, fill=NA)
gg <- gg + geom_map(data=df, map=usa_map,
aes(fill=colors, map_id=region),
color="#2b2b2b", size=0.15)
gg <- gg + scale_color_identity()
gg <- gg + coord_map("polyconic")
gg <- gg + ggthemes::theme_map()
gg
read.table(text="region  colors
1   alabama            #f7931e
2   arizona            #f7931e
3   arkansas           #4a77bb
4   california           #787878
5   colorado            #d3dfbd
6   connecticut            #f7931e
7    delaware            #f7931e
8    florida            #f7931e
9    georgia            #f7931e
11    idaho            #f7931e
12    illinois            #f7931e
13    indiana            #f7931e
14    iowa            #f7931e
15    kansas            #f7931e
16    kentucky            #f7931e
17    louisiana           #f7931e
18    maine            #f7931e
19    maryland            #f7931e
20    massachusetts            #f7931e
21    michigan            #f7931e
22    minnesota            #f7931e
23    mississippi            #f7931e
24    missouri            #f7931e
25    montana            #f7931e
26    nebraska            #f7931e
27    nevada            #f7931e
28    new hampshire            #f7931e
29    new jersey          #f7931e
30    new mexico            #f7931e
31    new york            #f7931e
32    north carolina            #f7931e
33    north dakota            #f7931e
34    ohio            #f7931e
35    oklahoma            #f7931e
36    oregon            #f7931e
37    pennsylvania            #f7931e
38    rhode island            #f7931e
39    south carolina            #f7931e
40    south dakota            #f7931e
41    tennessee            #f7931e
42    texas            #f7931e
43    utah            #f7931e
44    vermont            #f7931e
45    virginia            #f7931e
46    washington            #f7931e
47    west virginia            #f7931e
48    wisconsin            #f7931e
49    wyoming            #f7931e",
stringsAsFactors=FALSE, header=TRUE, comment.char="") -> df
read.table(text="region  colors
1   alabama            #f7931e
2   arizona            #f7931e
3   arkansas           #4a77bb
4   california           #787878
5   colorado            #d3dfbd
6   connecticut            #f7931e
7    delaware            #f7931e
8    florida            #f7931e
9    georgia            #f7931e
11    idaho            #f7931e
12    illinois            #f7931e
13    indiana            #f7931e
14    iowa            #f7931e
15    kansas            #f7931e
16    kentucky            #f7931e
17    louisiana           #f7931e
18    maine            #f7931e
19    maryland            #f7931e
20    massachusetts            #f7931e
21    michigan            #f7931e
22    minnesota            #f7931e
23    mississippi            #f7931e
24    missouri            #f7931e
25    montana            #f7931e
26    nebraska            #f7931e
27    nevada            #f7931e
28    new\shampshire            #f7931e
#Heatmap.2 exploration
my_palette <- colorRampPalette(c("blue", "white", "red"))(n = 299)
heatmap.2(scale(combo.all_temp[2:37]), scale = "none", main = "All Temp Explo", col = my_palette,
trace = "none", density.info = "none", dendrogram="row",Colv="NA")
library("gplots")
require("RColorBrewer")
#Heatmap.2 exploration
my_palette <- colorRampPalette(c("blue", "white", "red"))(n = 299)
heatmap.2(scale(combo.all_temp[2:37]), scale = "none", main = "All Temp Explo", col = my_palette,
trace = "none", density.info = "none", dendrogram="row",Colv="NA")
h3 <- heatmap(scale(combo.all_temp[2:37]), distfun = dist, keep.dendro = T,labRow = combo.all_temp$state,
main="Cluster on all temp", xlab = "Month", col = my_palette)
h3 <- heatmap(scale(combo.all_temp[2:37]), colors = my_palette, distfun = dist, keep.dendro = T,labRow = combo.all_temp$state,
main="Cluster on all temp", xlab = "Month")
library("pheatmap")
pheatmap(scale(combo.all_temp[2:37]))
dev.off()
